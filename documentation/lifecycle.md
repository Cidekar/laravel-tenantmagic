#### Lifecycle
As discussed in the [Laravel Request Lifecycle](https://laravel.com/docs/7.x/lifecycle) "When using any tool in the "real world", you feel more confident if you understand how that tool works. Application development is no different. When you understand how your development tools function, you feel more comfortable and confident using them."

Tenantmagic, provides one approach to a making your Passport password grant client tenant aware right out of the box; best to understand how it "works".

If you are not clear on the Laravel request lifecycle, please make sure you review [Laravel Request Lifecycle](https://laravel.com/docs/7.x/lifecycle) before digging into this document.

##### Request
The package is underpinned by Laravel Multitenancy and uses the ```SwitchTenantTask``` to make Laravel Passport [tenant aware](https://spatie.be/docs/laravel-multitenancy/v1/advanced-usage/using-a-custom-tenant-model#breadcrumb). The authorization token request injects a thin layer of logic around Passport allowing the package to make your application "aware" of multiple tenants augmenting the standard Passport token request lifecycle:

1. POST request to ```api/v1/oauth/``` for a access token; generated by Passport.
2. The ```TenantmagicController``` checks the request for scopes and passes the request deeper into the application.
3. Tenantmagic overrides Passport's ```findForPassport``` and ```validateForPassportPasswordGrant``` methods.
4. Tenantmagic attempts to find the tenant by iterating through the tenant databases and binding the tenant to the current route.
5. Attaches the tenant's domain(s) to the response via an x-magictenant-header.
6. Returns a Passport generated response from the controller.
